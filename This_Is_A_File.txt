
SELECT 
AREAID
--,ENTITYTYPEID
--,GEOM
--,OFFICEID
--,DOORSTOTAL
--,CREATEDBY
--,PINS
--,STATUS
--,NAME
--,DOORSCOMPLETE
--,ASSIGNMENTDATE
--,PARENT
--,ORIGGEOM
, REGEXP_COUNT(ORIGGEOM, ',', 1)
FROM prod.SOURCE_PDA_INTERNAL.areas
WHERE status = 'active'


CREATE OR REPLACE TABLE VDATA_JEREMY.DEV.WHYGOD AS (
select table1.value
     --TRY_TO_DECIMAL(table1.value, 10, 7) 
    from table(split_to_table('-99.94733701924497 49.8788139782846, -99.94702906812239 
49.87858498468994, -99.94704105424393 49.87854994833469, -99.94704700539515 49.87634399905799, 
-99.9470370309304 49.87627996131778, -99.94700903537381 49.87623092718422, 
-99.94698103981722 49.87620192579926, -99.94681507813436 49.87618893384934, 
-99.94327204766296 49.87619195133448, -99.94284700135302 49.87619496881961, 
-99.94276402051162 49.87619597464801, -99.94274507741039 49.87585692666471, 
-99.94275304021846 49.87576799467205, -99.94280207435202 49.87563899718224, 
-99.94277307296704 49.87569599412382, -99.94274507741039 49.87585692666471, 
-99.94276100302648 49.87614291720093, -99.94276402051162 49.87619597464801, 
-99.94318806099312 49.87619195133448, -99.94327204766296 49.87619195133448, 
-99.94327003600618 49.87655698321761, -99.94324807541987 49.87845992669463, 
-99.94329208041154 49.87853393889963, -99.94335704016112 49.87857492640616, 
-99.94357907677617 49.87858892418443, -99.94354605207769 49.87858993001282, 
-99.94335704016112 49.87857492640616, -99.94329208041154 49.87853393889963, 
-99.94324807541987 49.87845992669463, -99.94327003600618 49.87655698321761, 
-99.94327104183456 49.87624492496252, -99.94327204766296 49.87619195133448, 
-99.94408500845174 49.87619295716286, -99.9441700009499 49.87619396299123, 
-99.94417905340532 49.87570798024535, -99.94418106506208 49.8756539169699, 
-99.94505202862086 49.87563396804035, -99.94426404590354 49.87565198913217, 
-99.94418106506208 49.8756539169699, -99.94417100677828 49.87613897770644, 
-99.9441700009499 49.87619396299123, -99.94335603433272 49.87619195133448, 
-99.94327204766296 49.87619195133448, -99.94327003600618 49.87655698321761, 
-99.94326903017782 49.87755292095244, -99.94324002879284 49.87835397943854, 
-99.94326006154142 49.8784949630499, -99.94332007596812 49.87855598330497, 
-99.94344002100252 49.87858892418443, -99.94446001479974 49.87858892418443, 
-99.94496007914306 49.87858791835604, -99.94692404287565 49.87860694527625, 
-99.94695203843224 49.8786029219627, -99.94697802233208 49.87860099412499
, -99.94702906812239 49.87858498468994, -99.94733701924497 49.8788139782846', ',')) as table1
    order by table1.value);

    
   SELECT --TRY_TO_DECIMAL(REGEXP_REPLACE(VALUE, '[^-.0-9]+'), 10, 7)
   VALUE
   FROM VDATA_JEREMY.DEV.WHYGOD
   



SELECT top 100 *
FROM prod.SOURCE_PDA_INTERNAL.areas
WHERE AREAID  = 787785





--I feel like this is the closest I've gotten...
SELECT AREAID, ORIGGEOM, SPLIT(REGEXP_REPLACE(ORIGGEOM, '[^-,0-9]+'),',')
FROM (SELECT AREAID, ORIGGEOM FROM prod.SOURCE_PDA_INTERNAL.areas WHERE AREAID = 787784)


--Working?
SELECT REGEXP_REPLACE('MULTIPOLYGON (((-93.025976352382386 34.478559687240207)))
, -93.000265985320652 34.485793295795219, -93.002721937486214 34.491383215378136
, -93.030229173176295 34.482925101841992, -93.025976352382386 34.478559687240207', '[^-,0-9]+');




